# NNS域名服务概览
# NNS 是什么
NNS是Neo的域名服务，是一个基于Neo区块链的分布式、开源和可扩展的域名系统。

NNS可以将域名解析到各种目标。最容易联想到的是Neo的地址（Address），或者智能合约（ScriptHash）。但我们设计这个系统时预留了足够的扩展性，可以在NNS不升级的情况下支持更多的解析目标种类。
# NNS 系统的功能
NNS系统有两个作用
一是将beautiful.neo 等人类可读的名称解析为机器使用的标识符，如Neo的地址等。
二是为域名提供描述性数据，比如whois，合约接口描述等

NNS 和 DNS的目标类似，或者说和ENS的目标一致^_^，基于区块链架构设计。使用和DNS一样用点(.)分割的域名称系统，域的所有者对隶属于他的子域名有完全的分配权利。

.neo .gas 这样的根域名由一个称为（注册器Registry）的智能合约管理。一个注册器管理一个根域名，并设定取得其一级域名所有权的规则。任何人均可遵照对应的注册器设定的规则取得一级域名的所有权。

# NNS系统架构
NNS有两个系统组件，注册器和解析器
## 注册器
（该概念取自ENS，但中国人的表达习惯有着很大的区别，我认为我们需要重新商议命名）
	注册器是一个承担中央管理职能的智能合约，他的存储区中保存了所有域和子域的列表，并存储了三个关键信息：
1.	域名的所有者（owner）
2.	该域名的解析器（resolver）
3.	该域名的TTL

## 所有者
域名的所有者可以是一个账户地址或者一个智能合约。
拥有域名的智能合约叫做登记员（ENS叫做registrar很多资料翻译为登记员，这个名称也值得商榷）
登记员是一个拥有域名的智能合约，可以将域名的子域名分发给其他用户。
域名的所有者(owner)可以
	1.设置域和解析器的TTL
	2.将域名的所有权转移到另一个地址
	3.更改子域名的所有权

如果域名的所有者是一个账户地址，那么用户可以调用注册器的接口管理二级域名。
如果域名的所有者是一个智能合约（登记员），则该登记员要遵守NNS的登记员规范。该登记员可自动化的管理二级域名

## 解析器
NNS最主要的功能，就是完成从域名到解析器的映射。
解析器是一个智能合约，他来完成实际将名字翻译成地址的实际过程。只要遵循NNS解析器规范，的智能合约都可以被配置到域名的映射目标。NNS会提供一些常用的解析器，比如将一个名字映射为一个固定的地址。
同一个域名根据请求解析的记录类型不同，需要解析器实现不同的一个或多个方法。
比如同一个域名 在ipv4请求中指向ipv4地址，在ipv6请求中指向ipv6地址
如果要增加新的记录类型，在对现有NNS规范没有颠覆性改变的情况下，都可以不需改动NNS系统，直接配置实现。
# 具体解析规则
NNS中存储的域名为32字节散列值，而不是域名原文的文本。这有几个设计原因：
1.	处理过程统一，允许任意长度的域名。
2.	一定程度保留了域名的隐私
3.	将域名转换为散列的算法称为NameHash，我们将在其他的文档资料中对他进行解释。
NameHash的定义方式为递归式
	比如aaa.neo 对应的
	hashA  =  hash256(hash256(“.neo”) + “aaa”)
	然后 bbb.aaa.neo对应的
	hashB  =  hash256(hashA+”bbb”)	
	那么 ccc.bbb.aaa.neo 对应的
	HashC  =  hash256(hashB+”ccc”)
这样的定义方式让我们可以将所有层次的域名，一级，二级到无数级，都扁平化的保存在一个Map<hash256, 解析器> 的数据结构中。

这正是注册器保存域名解析的方法

意思这个递归计算NameHash的方式，以后都表达为
Hash = NameHash(“xxx.xxx.xxx…”);
NameHash实现方法另外撰文。

